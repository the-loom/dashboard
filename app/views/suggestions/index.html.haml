
- if params[:action] == "dismissed"
  - nav_add 'Sugerencias', suggestions_path
  - nav_add 'Rechazadas', '#'
- else
  - nav_add 'Sugerencias', '#'
= nav_render

- if policy(Suggestion).manage?
  - if params[:action] == "index"
    = link_to({ controller: 'suggestions', action: 'dismissed' }, { class: 'btn btn-default' }) do
      %i.fa.fa-recycle
      Sugerencias rechazadas

- if policy(Suggestion).use?
  = link_to 'Nueva sugerencia', new_suggestion_path, class: 'btn btn-primary'
  %br/
  %br/

- if @suggestions.empty?
  .alert.alert-info
    %p Aún no hay ninguna sugerencia
- else
  %table.suggestions.table.table-hover
    %thead
      %tr
        %th Tipo
        %th Sugerencia
        %th Sugerido por
        - if policy(Suggestion).manage?
          %th.no-sort  
    %tbody
      - @suggestions.each do |suggestion|
        %tr
          %td
            = t "suggestions.suggestion_type.#{suggestion.suggestion_type}"
          %td
            %p
              %strong= suggestion.title
            %p!= suggestion.body
          %td
            = suggestion.author.short_name
          - if policy(Suggestion).manage?
            %td
              = link_to "Eliminar", suggestion_path(suggestion), method: :delete, class: 'btn btn-danger btn-sm'

= content_for :head do
  %link{href: "https://cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css", rel: "stylesheet"}

= content_for :javascript do
  %script{src: "https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js", type: "application/javascript"}
  :javascript
    $(function () {
      $('.suggestions').DataTable({
        order: [[1, "asc"]],
        paging: false,
        language: {
          url: "https://cdn.datatables.net/plug-ins/1.10.19/i18n/Spanish.json"
        },
        columnDefs: [{
          targets: 'no-sort',
          orderable: false
        }]
      });
    });
