<link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
<div class="fb-profile">
  <%= image_tag "team-background.jpg", { align: 'left', class: 'fb-image-lg'} %>
  <img align="left" class="fb-image-profile thumbnail" src="<%= @team.image %>" alt="Profile image example"/>
  <div class="fb-profile-text">
    <h1>
      <%= @team.name %>
      <small><%= @team.nickname %></small>
    </h1>
    <div class="student dashboard">
      <div class="col-md-3 box">
        <span class="number"><%= @team.points %></span>
        <label title="Experiencia">XP</label>
      </div>
    </div>
  </div>
</div>

<div class="clearfix"></div>

<div class="students mosaic">
  <div class="row">
    <div class="col-md-12">
      <legend>Integrantes</legend>
      <% @team.members.each do |student| %>
        <div class="col-md-2 col-xs-6 student-box">
          <%= link_to user_details_url(student.nickname) do %>
            <img class="avatar<%= ' disabled' unless student.enabled? %>" src="<%= student.image %>">
            <p class="data">
              <%= student.nickname %><br/>
              <small><%= student.name %></small><br/>
            </p>
          <% end %>
          <p>Nivel <span class="badge"><%= student.level %></span> /
            <%= student.points %> XP</p>
        </div>
      <% end %>
    </div>
  </div>

  <% if policy(Team).manage? %>
    <div class="row">
      <div class="col-md-12">
        <%= form_for @team, url: team_add_member_path(@team), html: { class: 'form-inline' } do |f| %>
          <div class="form-group">
            <input id="partner" name="nickname" class="form-control" type="text" data-provide="typeahead" placeholder="Usuario de github">
          </div>
          <button type="submit" class="btn">
            Agregar miembro
          </button>
        <% end %>
      </div>
      <% content_for :javascript do %>
        <script>
            $(function(){
                $.get("/partners", function(data){
                    $("#partner").typeahead({ source:data });
                },'json');
            });
        </script>
      <% end %>
      <br/><br/><br/><hr/>
    </div>
  <% end %>
</div>

<div class="col-md-6">
  <legend>Emblemas del grupo
    <small>(<%= @team.badges.uniq.size %> / <%= Badge.count %>)</small>
  </legend>

  <% if @team.badges.size == 0 %>

    <div class="alert alert-info">
      <p>AÃºn no se te otorgaron emblemas...</p>
    </div>

  <% else %>
    <% @team.badges.uniq.each do |badge| %>
      <div class="col-md-4 badge-box">
        <div class="panel panel-default">
          <div class="panel-heading">
            <%= badge.name %>
          </div>
          <div class="panel-body">
            <img class="loom-badge" src="http://www.delucas.com.ar/loom/badges/<%= badge.slug %>.png" data-toggle="tooltip"
                 data-placement="bottom" title="<%= badge.description %>"/>
          </div>
          <div class="panel-footer">
            <span class="label label-info">&times; <%= @team.badges.count(badge) %></span>
          </div>
        </div>
      </div>
    <% end %>
    <% (Badge.all - @team.badges).each do |badge| %>
      <div class="col-md-4 badge-box">
        <div class="panel panel-default">
          <div class="panel-heading">
            <%= badge.name %>
          </div>
          <div class="panel-body">
            <img class="loom-badge" src="http://www.delucas.com.ar/loom/badges/incognito.png" data-toggle="tooltip"
                 data-placement="bottom" title="<%= badge.description %>"/>
          </div>
          <div class="panel-footer">
            &nbsp;
          </div>
        </div>
      </div>
    <% end %>
  <% end %>
</div>

<% content_for :javascript do %>
  <script>
      $(function () {
          $('[data-toggle="tooltip"]').tooltip()
      });
  </script>
<% end %>
